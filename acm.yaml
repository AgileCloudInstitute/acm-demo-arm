## Copyright 2022 Green River IT (GreenRiverIT.com) as described in LICENSE.txt distributed with this project on GitHub.  
## Start at https://github.com/AgileCloudInstitute?tab=repositories    

#Start agents system
agents:
  keysDir: $Default
  cloud: azure
  organization: x1b2c
  tags:
    networkName: name-of-vnet
    systemName: name-of-system
    environmentName: name-of-environment
    ownerName: name-of-owner
  foundation:
    instanceName: arm-demox
    deploymentName: devenvironmentx
    templateName: azure-building-blocks/arm/foundation.template.json
    emptyTemplateName: azure-building-blocks/arm/empty.template.json
    controller: arm
    resourceGroupName: myResourceGroupDevx
    resourceGroupRegion: westus
    preprocessor: 
      locationOn: azure-building-blocks/scripts/hello1.py
      commandOn: python $location
      locationOff: azure-building-blocks/scripts/hello2.py
      commandOff: python $location
    postprocessor:
      locationOn: azure-building-blocks/scripts/hello3.py
      commandOn: python $location
      locationOff: azure-building-blocks/scripts/hello4.py
      commandOff: python $location
    mappedVariables:
      resourceGroupName: $this.instance.resourceGroupName
    images:
      - instanceName: arm-demo-imgx
        deploymentName: devenvimagesx
        templateName: azure-building-blocks/arm/imagebuilder.template.json
        emptyTemplateName: azure-building-blocks/arm/empty.template.json
        controller: arm
        imageName: initialimagemx
        runOutputName: initialoutputx
        resourceGroupName: myResourceGroupDevx
        mappedVariables: 
          resourceGroupName: $this.instance.resourceGroupName
          resourceGroupRegion: $this.foundation.resourceGroupRegion
          subscriptionId: $keys.subscriptionId
          imgBuilderId: $customFunction.imageBuilderId
          imageTemplateName: $customFunction.imageTemplateName
          currentDateTimeAlphaNumeric: $customFunction.currentDateTime
          imageName: $this.instance.imageName
          runOutputName: $this.instance.runOutputName
  serviceTypes:
    subnetsWithScaleSet:
      instances:
        - instanceName: azdoAgentsx
          deploymentName: serviceInstancex
          templateName: azure-building-blocks/arm/vm-portal.template.json
          emptyTemplateName: azure-building-blocks/arm/empty.template.json
          controller: arm
          resourceGroupName: myServiceInstancex
          resourceGroupRegion: westus
          preprocessor: 
            locationOn: azure-building-blocks/scripts/hello1.py
            commandOn: python $location
            locationOff: azure-building-blocks/scripts/hello2.py
            commandOff: python $location
          postprocessor:
            locationOn: azure-building-blocks/scripts/hello3.py
            commandOn: python $location
            locationOff: azure-building-blocks/scripts/hello4.py
            commandOff: python $location
          mappedVariables:
            dnsLabelPrefix: agents
            vnetCidr: 10.0.0.0/16
            subnetCidr: 10.0.0.0/24
            publicIPAddressType: Dynamic
            resourceGroupRegion: $this.instance.resourceGroupRegion
            VmName: KokoTaylorx
            subnetName: agentsSubnetx
            imageName: $customFunction.mostRecentImage.initialimagem
            NicName: agentsNic
            vnetName: agentsVnet1
            foundationResourceGroupName: $this.foundation.resourceGroupName
